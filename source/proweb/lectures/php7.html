<!DOCTYPE html>
<html class="page" lang="ru">

<head>
  <meta charset="utf-8">
  <title>PHP Формы</title>
  <link rel="shortcut icon" href="../../img/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="../../css/style.css">
</head>

<body class="page__body">

  <section class="modal">
    <div class="modal__wrapper">
      <div class="modal__block">
        <h3 class="modal__title">Размер шрифта:</h3>
        <button type="button" class="button button--accessibility fontsize-standart"
          title="Стандартный размер шрифта">А</button>
        <button type="button" class="button button--accessibility fontsize-2x"
          title="Увелеченный дважды размер шрифта">А</button>
        <button type="button" class="button button--accessibility fontsize-4x"
          title="Увелеченный четырежды размер шрифта">А</button>
      </div>
      <div class="modal__block">
        <h3 class="modal__title">Цвет сайта:</h3>
        <button type="button" class="button button--accessibility color-whiteblack" title="Бело-черный стиль">А</button>
        <button type="button" class="button button--accessibility color-blackwhite" title="Черно-белый стиль">А</button>
        <button type="button" class="button button--accessibility color-blue" title="Сине-голубой стиль">А</button>
        <button type="button" class="button button--accessibility color-standart" title="Стандартный стиль">А</button>
      </div>
      <div class="modal__block">
        <h3 class="modal__title">Изображения:</h3>
        <button type="button" class="button button--accessibility image-off" title="Отключить изображение"><span
            class="visually-hidden">Выкл.</span></button>
        <button type="button" class="button button--accessibility image-on" title="Включить изображение"><span
            class="visually-hidden">Вкл.</span><svg class="image__svg" version="1.1" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 350 350">
            <path
              d="M5,350h340V0H5V350z M25,330v-62.212h300V330H25z M179.509,247.494H60.491L120,171.253L179.509,247.494z   M176.443,211.061l33.683-32.323l74.654,69.05h-79.67L176.443,211.061z M325,96.574c-6.384,2.269-13.085,3.426-20,3.426  c-33.084,0-60-26.916-60-60c0-6.911,1.156-13.612,3.422-20H325V96.574z M25,20h202.516C225.845,26.479,225,33.166,225,40  c0,44.112,35.888,80,80,80c6.837,0,13.523-0.846,20-2.518v130.306h-10.767l-104.359-96.526l-45.801,43.951L120,138.748  l-85.109,109.04H25V20z" />
          </svg></button>
      </div>
    </div>
  </section>

  <button type="button" class="accessibility" title="Открыть панель доступности"><svg width="50" height="50"
      viewBox="0 0 1750 1750" xmlns="http://www.w3.org/2000/svg">
      <path class="accessibility__svg"
        d="M1664 960q-152-236-381-353 61 104 61 225 0 185-131.5 316.5t-316.5 131.5-316.5-131.5-131.5-316.5q0-121 61-225-229 117-381 353 133 205 333.5 326.5t434.5 121.5 434.5-121.5 333.5-326.5zm-720-384q0-20-14-34t-34-14q-125 0-214.5 89.5t-89.5 214.5q0 20 14 34t34 14 34-14 14-34q0-86 61-147t147-61q20 0 34-14t14-34zm848 384q0 34-20 69-140 230-376.5 368.5t-499.5 138.5-499.5-139-376.5-368q-20-35-20-69t20-69q140-229 376.5-368t499.5-139 499.5 139 376.5 368q20 35 20 69z">
      </path>
    </svg></button>
  <div class="page__wrapper">

    <header class="header">

      <nav class="nav">
        <ul class="nav__list">
          <li class="nav__item">
            <a class="nav__link" href="../../index.html">Главная</a>
          </li>
          <li class="nav__item">
            <a class="nav__link" href="../lectures.html">Лекции</a>
          </li>
          <li class="nav__item">
            <a class="nav__link" href="../video.html">Видео-уроки</a>
          </li>
          <li class="nav__item">
            <a class="nav__link" href="../practical.html">Лабораторные работы</a>
          </li>
          <li class="nav__item">
            <a class="nav__link" href="../tests.html">Тесты</a>
          </li>
        </ul>
      </nav>

    </header>

    <main class="content">
      <h1 class="content__title">Работа с формами</h1>
      <p>Для передачи данных от пользователя Web-страницы на сервер используются
        HTML-формы. Для работы с формами в PHP предусмотрен ряд специальных средств.

      </p>
      <h2>Предварительно определенные переменные</h2>
      <p>В PHP существует ряд предварительно определенных переменных, которые
        не меняются при выполнении всех приложений в конкретной среде. Их также
        называют переменными окружения или переменными среды. Они отражают установки
        среды Web-сервера Apache, а также информацию о запросе данного браузера. Есть
        возможность получить значения URL, строки запроса и других элементов
        HTTP-запроса.
      </p>
      <p>Все предварительно определенные переменные содержатся в ассоциативном
        массиве $GLOBALS. Кроме переменных окружения этот массив содержит
        также глобальные переменные, определенные в программе.
      </p>
      <h4>Пример 1</h4>
      <pre class="code">&lt;html&gt;
    &lt;head&gt;
    &lt;title&gt;Просмотр массива $GLOBALS&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;?php
      $a = "Hello!";
      foreach ( $GLOBALS as $key=&gt;$value )
        echo "\$GLOBALS[\"$key\"] == $value&lt;br&gt;";
    ?&gt;
    &lt;/body&gt;
    &lt;/html&gt;</pre>
      <p>В результате на экране появится список всех глобальных переменных,
        включая переменные окружения. Наиболее часто используемые из них:</p>
      <table class="table">
        <tbody>
          <tr class="table__row">
            <th>Переменная</th>
            <th>Описание</th>
            <th>Cодержание</th>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['HTTP_USER_AGENT']</td>
            <td class="table__cell">Название и версия клиента</td>
            <td class="table__cell">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)
              Chrome/71.0.3578.98
              Safari/537.36</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['REMOTE_ADDR']</td>
            <td class="table__cell">IP-адрес</td>
            <td class="table__cell">31.173.241.82</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">getenv('HTTP_X_FORWARDED_FOR')</td>
            <td class="table__cell">Внутренний IP-адрес клиента</td>
            <td class="table__cell"></td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['REQUEST_METHOD']</td>
            <td class="table__cell">Метод запроса (GET или POST)</td>
            <td class="table__cell">GET</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['QUERY_STRING']</td>
            <td class="table__cell">При запросе GET закодированные данные, передаваемые вместе с URL</td>
            <td class="table__cell"></td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['REQUEST_URL']</td>
            <td class="table__cell">Полный адрес клиента, включая строку запроса</td>
            <td class="table__cell"></td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['HTTP_REFERER']</td>
            <td class="table__cell">Адрес страницы, с которой был сделан запрос</td>
            <td class="table__cell">https://htmlweb.ru/php/php6.php</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['PHP_SELF']</td>
            <td class="table__cell">Путь к выполняемой программе</td>
            <td class="table__cell">/index.php</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['SERVER_NAME']</td>
            <td class="table__cell">Домен</td>
            <td class="table__cell">htmlweb.ru</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_SERVER['REQUEST_URI']</td>
            <td class="table__cell">Путь</td>
            <td class="table__cell">/php/php_form.php</td>
          </tr>
        </tbody>
      </table>

      <h2>Обработка ввода пользователя</h2>
      <p>PHP-программу обработки ввода можно отделить от HTML-текста, содержащего
        формы ввода, а можно расположить на одной странице.
      </p>
      <h4>Пример 2</h4>
      <pre class="code">&lt;?php
    if ( ! isset( $cardnumber ) )
       $m = "Введите номер карточки";
    elseif ( $cardnumber == "" )
       $m = "Ваш номер пуст!";
    else
       $m = "Ваш номер: $cardnumber";
    ?&gt;
    &lt;html&gt;
    &lt;head&gt;
    &lt;title&gt;Пример обработки ввода&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;h1&gt;&lt;?php echo $m?&gt;&lt;/h1&gt;
    &lt;form name="form1" action="&lt;?=$_SERVER['PHP_SELF']?&gt;" method="post"&gt;
          &lt;p&gt;Номер карточки:
          &lt;input name="cardnumber" type="text" size="20"&gt;
    &lt;/form&gt;
    &lt;/body&gt;
    &lt;/html&gt;</pre>
      <p>Здесь отсутствует кнопка передачи данных, т.к. форма, состоящая из одного
        поля, передается автоматически при нажатии клавиши &lt;Enter&gt;.
      </p>
      <p>При обработки элемента с многозначным выбором для доступа ко всем выбранным
        значениям нужно к имени элемента добавить пару квадратных скобок. Для выбора нескольких эллементов следует
        удерживать клавишу Ctrl.</p>

      <h4>Пример 3.1</h4>
      <p>Файл ex.htm</p>
      <pre class="code">&lt;html&gt;
    &lt;head&gt;
    &lt;title&gt;Список&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;form name="form1" action="ex1.php" method="post"&gt;
    &lt;select name="Item[]" size=5 multiple&gt;
    &lt;option&gt;Чай
    &lt;option&gt;Кофе
    &lt;option&gt;Молоко
    &lt;option&gt;Ветчина
    &lt;option&gt;Сыр
    &lt;/select&gt;
    &lt;input type="submit" value="ВВОД"&gt;
    &lt;/form&gt;
    &lt;/body&gt;
    &lt;/html&gt;</pre>

      <h4>Пример 3.2</h4>
      <p>Файл ex.php</p>
      <pre class="code">&lt;html&gt;
    &lt;head&gt;
    &lt;title&gt;Обработка списка из файла ex1.htm&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;?php
    echo "Ваш заказ: &lt;p&gt;&lt;ul&gt;";
    foreach ( $Item as $value )   echo "&lt;li&gt;$value";
    echo "&lt;/ul&gt;";
    ?&gt;
    &lt;/body&gt;
    &lt;/html&gt;</pre>

      <h4>Пример 4. Прием значений от checkbox-флажков</h4>
      <pre class="code">&lt;?php
    if (@$_REQUEST['doGo']) {
      foreach (@$_REQUEST['known'] as $k=&gt;$v) {
        if($v) echo "Вы знаете язык программирования $k!&lt;br&gt;";
        else echo "Вы не знаете языка программирования $k. &lt;br&gt;";
      }
    }
    ?&gt;
    &lt;form action="&lt;?=$_SERVER['SCRIPT_NAME']?&gt;" method="post"&gt;
    Какие языки программирования вы знаете?&lt;br&gt;
    &lt;input type=hidden name="known[PHP]" value="0"&gt;
      &lt;input type=checkbox name="known[PHP]" value="1"&gt; PHP&lt;br&gt;
    &lt;input type=hidden name="known[Perl]" value="0"&gt;
      &lt;input type=checkbox name="known[Perl]" value="1"&gt; Perl&lt;br&gt;
    &lt;input type=submit name="doGo" value="Go!"&gt;
    &lt;/form&gt;</pre>

      <h4>Пример 5</h4>
      <pre class="code">&lt;?php // Модель скрипта, принимающего текст от пользователя.
    if (@$_REQUEST['text'])
      echo htmlspecialchars($_REQUEST['text'])."&lt;hr&gt;";
    ?&gt;
    &lt;form action="&lt;?=$_SERVER['SCRIPT_NAME']?&gt;" method="post"&gt;
    &lt;textarea name="text" cols="60" rows="10"&gt;
    &lt; ?=@htmlspecialchars($_REQUEST['text'])?&gt;
    &lt;/textarea&gt;&lt;br&gt;
    &lt;input type="submit"&gt;
    &lt;/form&gt;</pre>
      <p>Можно обрабатывать формы, не заботясь о фактических именах полей.</p>
      <p>Для этого можно использовать (в зависимости от метода передачи)
        ассоциативный массив $HTTP_GET_VARS или $HTTP_POST_VARS.
        Эти массивы содержат пары имя/значение для каждого элемента переданной формы. Если Вам все равно,
        Вы можете использовать ассоциативный массив $_REQUEST.</p>

      <h4>Пример 6</h4>
      <pre class="code">&lt;html&gt;
    &lt;head&gt;
    &lt;title&gt;Обработка произвольного ввода
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;независимо от метода передачи&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
    &lt;?php
    $params = ( $_SERVER['REQUEST_METHOD'] == "GET" )
       ? $HTTP_GET_VARS : $HTTP_POST_VARS;
      foreach ( $params as $key=&gt;$value )
        echo "$key == $value&lt;br&gt;";
    ?&gt;
    &lt;/body&gt;
    &lt;/html&gt;</pre>

      <h4>Пример 7. Обработка нажатия на кнопку с использованием оператора '@'.</h4>
      <pre class="code">&lt;?php
    if (@$_REQUEST['submit']) echo "Кнопка нажата!"
    ?&gt;
    &lt;form action="&lt;?=$_SERVER['SCRIPT_NAME']?&gt;"&gt;
    &lt;input type="submit" name="submit" value="Go!"&gt;
    &lt;/form&gt;</pre>
      <p>С помощью функции header(), послав браузеру заголовок
        "Location", можно перенаправить пользователя на новую страницу.</p>
      <p>Например:</p>
      <pre class="coder">&lt;? header("Location: ex2.php"); ?&gt;</pre>

      <h2>Передача файла на сервер. UpLoad</h2>
      <p>PHP позволяет передавать на сервер файлы. HTML-форма, предназначенная для
        передачи файла, должна содержать аргумент enctype="multipart/form-data".
      </p>
      <p>Кроме того в форме перед полем для копирования файла должно находиться
        скрытое поле с именем max_file_size. В это скрытое поле должен
        быть записан максимальный размер передаваемого файла (обычно не больше 2 Мбайт).
      </p>
      <p>Само поле для передачи файла - обычный элемент INPUT с аргументом type="file".
      </p>
      <p>Например:
      </p>
      <pre class="code">&lt;form enctype="multipart/form-data"
    &nbsp;&nbsp;&nbsp;&nbsp;action="&lt;?echo $_SERVER['PHP_SELF']?&gt;" method="post"&gt;
    &lt;input type="hidden" name="max_file_size" value="51200"&gt;
    &lt;input type="file" name="myfile"&gt;&lt;br&gt;
    &lt;input type="submit" value="ВВОД"&gt;
    &lt;/form&gt;</pre>
      <p>После того, как файл передан на сервер, он получает уникальное имя и
        сохраняется в каталоге для временных файлов. Полный путь к файлу записывается в
        глобальную переменную, имя которой совпадает с именем поля для передачи этого
        файла. Кроме этого PHP сохраняет еще некоторую дополнительную информацию о
        переданном файле в других глобальных переменных:

      </p>
      <p></p>
      <table class="table">
        <tbody>
          <tr class="table__row">
            <th>Переменная</th>
            <th>Описание</th>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_FILES['userfile']['name'] </td>
            <td class="table__cell"> оригинальное имя файла, такое, каким его видел пользователь, выбирая файл</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_FILES['userfile']['type'] </td>
            <td class="table__cell"> mime/type файла, к примеру, может быть image/gif; это поле полезно сохранить, если
              Вы хотите предоставлять
              интерфейс для скачивания загруженных файлов</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_FILES['userfile']['size'] </td>
            <td class="table__cell"> размер загруженного файла</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_FILES['userfile']['tmp_name'] </td>
            <td class="table__cell"> полный путь к временному файлу на диске</td>
          </tr>
          <tr class="table__row">
            <td class="table__cell">$_FILES['userfile']['error'] </td>
            <td class="table__cell">код ошибки, который равен 0, если операция прошла успешно</td>
          </tr>
        </tbody>
      </table>
      <h4>Пример 8</h4>
      <pre class="code">&lt;html&gt;
    &lt;head&gt;
    &lt;title&gt;Обработка переданного файла&lt;/title&gt;
    &lt;/head&gt;
    &lt;?php
    if ( isset( $_FILES['userfile']['tmp_name'] ) )
      {
       echo "путь: ".$_FILES['userfile']['tmp_name']."&lt;br&gt;";
       echo "имя: ".$_FILES['userfile']['name']."&lt;br&gt;";
       echo "размер: ".$_FILES['userfile']['size']."&lt;br&gt;";
       echo "тип: ".$_FILES['userfile']['type']."&lt;br&gt;";
      }

    ?&gt;
    &lt;body&gt;
    &lt;form enctype="multipart/form-data"
    &nbsp;&nbsp;&nbsp;&nbsp;action="&lt;?echo $_SERVER['PHP_SELF']?&gt;" method="post"&gt;
    &lt;input type="hidden" name="max_file_size" value="51200"&gt;
    &lt;input type="file" name="userfile"&gt;&lt;br&gt;
    &lt;input type="submit" value="ВВОД"&gt;
    &lt;/form&gt;
    &lt;/body&gt;
    &lt;/html&gt;</pre>
      <button type="button" class="button"><a class="button__link" href="php6.html">Предыдущая лекция</a></button>
      <button type="button" class="button"><a class="button__link" href="php8.html">Следующая лекция</a></button>

    </main>

  </div>

  <script src="../../js/accessibility.js"></script>

</body>

</html>
